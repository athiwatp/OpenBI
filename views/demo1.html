<%- include header.html %>


<div class='container'>
  <ul class='title'>
    <li>
      <a href="#drawer" class="uk-icon-button uk-icon-navicon" id='navicon'
        data-uk-offcanvas></a>
    </li>
    <li>
      <a href="" class="uk-icon-button uk-icon-refresh"
        onclick='location.reload()'></a>
    </li>
    <li>Demo
    </li>
  </ul>
</div>


<div id="ring-year"></div>
<div id="chart-hist-spend"></div>
<div id="chart-row-spenders"></div>

<script src="/js/d3.js"></script>
<script src="/js/crossfilter.js"></script>
<script src="/js/dc.js"></script>

<script>

var yearRingChart   = dc.pieChart("#ring-year"),
    spendHistChart  = dc.barChart("#chart-hist-spend"),
    spenderRowChart = dc.rowChart("#chart-row-spenders");

// use static or load via d3.csv("spendData.csv",
// function(error, spendData) {/* do stuff */});
var spendData = [
    {Name: 'Mr A', Spent: '40', Year: 2011},
    {Name: 'Mr B', Spent: '10', Year: 2011},
    {Name: 'Mr C', Spent: '40', Year: 2011},
    {Name: 'Mr A', Spent: '70', Year: 2012},
    {Name: 'Mr B', Spent: '20', Year: 2012},
    {Name: 'Mr B', Spent: '50', Year: 2013},
    {Name: 'Mr C', Spent: '30', Year: 2013}
];

var ndx = crossfilter(spendData),
    yearDim  = ndx.dimension(function(d) {return d.Year;}),
    spendDim = ndx.dimension(function(d) {return Math.floor(d.Spent / 1.0);}),
    nameDim  = ndx.dimension(function(d) {return d.Name;}),

    spendPerYear =  yearDim.group().reduceSum(dc.pluck('Spent')),
    spendHist    = spendDim.group().reduceSum(dc.pluck('Spent')),
    spendPerName =  nameDim.group().reduceSum(dc.pluck('Spent')),
    xx = 0;

yearRingChart
    .width(200).height(200)
    .dimension(yearDim)
    .group(spendPerYear)
    .innerRadius(50)
    .transitionDuration(1000)
    ;

spendHistChart
    .width(300).height(200)
    .dimension(spendDim)
    .group(spendHist)
    .x(d3.scale.linear().domain([0,100]))
    .elasticY(true)
    .transitionDuration(1000)
    ;

spenderRowChart
    .width(350).height(200)
    .dimension(nameDim)
    .group(spendPerName)
    .elasticX(true)
    .transitionDuration(1000)
    ;

dc.renderAll();




</script>


<%- include drawer.html %>
<%- include footer.html %>
