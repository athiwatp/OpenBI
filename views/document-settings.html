<div id="settings" class="uk-modal">
	<div class="uk-modal-dialog">
		<a class="uk-modal-close uk-close"></a>
		<h1>Settings</h1>

		<form class='uk-form' method='post' action='/document-save'
			enctype="multipart/form-data" >
			<input type='hidden' name='document' value='<%= document.id %>' />
			<input type='file' name='file'
				style='display:none; width:4px; height:4px;' />

			<div class='uk-grid uk-grid-preserve'>
				<div class='uk-width-3-10'>
					<label>Name</label>
				</div>
				<div class='uk-width-7-10'>
					<input type='text' name='name' class='uk-width-1-1'
					   value='<%= document.name %>' />
				</div>

				<div class='uk-width-3-10'>
					<label>Upload Data</label>
				</div>
				<div class='uk-width-7-10'>
					<input type='button' class='uk-button' value='Choose File'
						onclick='javascript:documentChooseFile()' />
				</div>

				<div class='uk-width-3-10'>
					<label>Public</label>
				</div>
				<div class='uk-width-7-10'>
					<input type='checkbox' name='public'
						 <%= document.public ? 'checked' : '' %> />
					<label for='public'>Allow everyone view this document.
					</label>
				</div>

				<div class='uk-width-1-1'>
					Data Preparation
					<a href='javascript:sampleCode()'>Sample</a>
					<br/>
					<textarea class='code' rows='4' name='init'
						placeholder="Data Preparation"
						><%- document.init %></textarea>
				</div>

				<div class='uk-width-1-1'>
					Theme
					<a href='javascript:theme("light")'>Light</a>
					<a href='javascript:theme("dark")'>Dark</a>
					<br/>
					<textarea class='code' rows='4' name='style'
						placeholder="Style"
						><%- document.style %></textarea>
				</div>

				<div class='uk-width-1-1 modal-button'>
					<input type='submit' value='Save'
					   class='uk-button uk-button-primary' />

					<!--
					<input type='button' value='Cancel'
					   class='uk-button'
					   onclick='javascript:documentSettingsClose()' />
					-->

					<input type='button' value='Delete'
						class='uk-button uk-button-danger'
						onclick='javascript:documentDelete()' />

				</div>
			</div>
		</form>
	</div>
</div>

<script>

var saveCount = 0;
function documentSaveLayout() {
	saveCount = 0;
	for (var i = 0; i < charts.length; i++) {
		saveChart(i);
	}
}

function documentDelete() {
	$.post('/document-delete/' + doc)
	.success(function(result) {
		window.location = '/';
	});
}

function documentChooseFile() {
	$('[name=file]').click();
}

function documentSettingsClose() {
	$.UIkit.modal("#settings").hide();
}

function sampleCode() {
	var s = "data.forEach(function(d) {\n  d.Count = 1;\n});";
	$('[name=init]').val(s);
}

function theme(name) {
	if (name === 'light') {
		$('[name=style]').val('');
	}
	else
	if (name === 'dark') {
		var s = "{\n  background: '#333',\n  text: '#eee',\n  chartTitle: '#777',\n  chartBorder: '#777',\n  chartBackground: '#555',  chartShadow: 'inset 0px 0px 300px rgba(0,0,0,.5)',\n  axis: 'white'\n}";
		$('[name=style]').val(s);
	}
}

</script>
